<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.18.0/font/bootstrap-icons.css"
      integrity="sha384-rI2DBIG3Fv2jRwe7z9tc3R8pWFM9gGQVoTo5hcc4M2jtEkhl1ykI78zY3hY5FGEW"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />

    <link rel="stylesheet" href="/css/styles.css" />
    <link rel="stylesheet" href="/css/header.css" />
    <link rel="stylesheet" href="/css/lista_tarefas.css" />
    <link rel="stylesheet" href="/css/card_criarpostagem.css" />
    <link rel="stylesheet" href="/css/post.css" />
    <link rel="stylesheet" href="/css/index.css" />

    <title>Job Delas</title>
  </head>
  <body>
    <header class="header"></header>
    <main>
      <section class="container_principal">
        <div class="lateral_home"></div>

        <div class="container_postagem">
          <div class="cardCriarPostagem"></div>

          <div class="feed">
            <div th:each="postagem : ${postagens}" class="post">
              <div class="user-info">
                <img
                  src="/img/iconfoto.png"
                  alt="User"
                  class="foto_criarpostagem"
                />
                <h4 th:text="${postagem.usuarios.getNome()}">Nome Usuario</h4>
              </div>
              <p
                th:text="${#temporals.format(postagem.data_postagem, 'dd/MM/yyyy HH:mm:ss')}"
                class="post-date"
              ></p>

              <p class="post-content" th:text="${postagem.conteudo}"></p>
              <div class="post-actions">
                <button class="like-button">
                  <i class="fas fa-heart"></i> Curtir
                </button>
                <button class="comment-button">
                  <i class="fas fa-comment"></i> Comentar
                </button>
                <button
                  class="read-comments-button"
                  data-toggle="modal"
                  th:data-target="'#comentariosModal_' + ${postagem.id}"
                >
                  <i class="fas fa-eye"></i> Ler Comentários
                </button>

                <!-- Modal -->
                <div
                  class="modal fade"
                  th:id="'comentariosModal_' + ${postagem.id}"
                  tabindex="-1"
                  role="dialog"
                  aria-labelledby="comentariosModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="comentariosModalLabel">
                          Comentários
                        </h5>
                        <button
                          type="button"
                          class="close"
                          data-dismiss="modal"
                          aria-label="Fechar"
                        >
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        <!-- Iteração dos comentários -->
                        <div
                          th:each="comentario : ${comentarios}"
                          class="comentario"
                        >
                          <p th:text="${comentario.conteudo}"></p>
                        </div>
                      </div>
                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          data-dismiss="modal"
                        >
                          Fechar
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
    <script src="/js/home.js" type="module"></script>

    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://kit.fontawesome.com/cda1aa7b4f.js"
      crossorigin="anonymous"
    ></script>

    <script>
      // Escute o evento de clique nos botões "Ler Comentários"
      document.querySelectorAll(".read-comments-button").forEach((button) => {
        button.addEventListener("click", function () {
          // Obtém o ID da postagem associado a este botão
          const postId = this.getAttribute("data-postid");

          // Aqui você pode usar esse postId para fazer uma requisição AJAX
          // e buscar os comentários correspondentes à postagem com este ID
          // Após obter os comentários, você pode exibi-los no modal
          // (Isso depende de como você planeja buscar os comentários do backend)

          // Exemplo simples de exibição dos comentários (substitua isso pelo seu código real)
          const modal = document.getElementById("comentariosModal");
          const comentariosDiv = modal.querySelector(".modal-body");

          // Limpando os comentários existentes no modal
          comentariosDiv.innerHTML = "";

          // Aqui você adicionaria os comentários correspondentes à postagem ao modal
          // Você precisará de um método para buscar os comentários do backend e adicionar
          // o HTML dos comentários à variável "comentariosDiv.innerHTML"

          // Exemplo de adição de um comentário fictício ao modal (substitua isso pelo seu código real)
          const comentarioHTML = `
      <div class="comentario">
        <strong>Nome do Comentador:</strong> Comentário
        <br />
        <small>Data do Comentário</small>
      </div>
    `;

          // Adicionando o comentário fictício ao modal
          comentariosDiv.insertAdjacentHTML("beforeend", comentarioHTML);
        });
      });
    </script>
  </body>
</html>
